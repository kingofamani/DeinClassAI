<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenWebUI API æ–‡æª” - é›¢ç·šç‰ˆæœ¬</title>
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/swagger-ui-dist@5.10.3/swagger-ui.css" />
    <style>
        html {
            box-sizing: border-box;
            overflow: -moz-scrollbars-vertical;
            overflow-y: scroll;
        }
        *, *:before, *:after {
            box-sizing: inherit;
        }
        body {
            margin:0;
            background: #fafafa;
        }
        .swagger-ui .topbar {
            background-color: #1f2937;
            border-bottom: 1px solid #374151;
        }
        .swagger-ui .topbar .download-url-wrapper {
            display: none;
        }
        .custom-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .custom-header h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 300;
        }
        .custom-header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1rem;
        }
        .info-panel {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .info-panel h3 {
            color: #2d3748;
            margin-top: 0;
        }
        .auth-info {
            background: #fef5e7;
            border-left: 4px solid #f6ad55;
            padding: 15px;
            margin: 20px;
            border-radius: 0 8px 8px 0;
        }
        .auth-info strong {
            color: #c05621;
        }
    </style>
</head>
<body>
    <div class="custom-header">
        <h1>ğŸš€ OpenWebUI API æ–‡æª”</h1>
        <p>å®Œæ•´çš„ API åƒè€ƒæ–‡æª” - é›¢ç·šç‰ˆæœ¬</p>
    </div>

    <div class="auth-info">
        <strong>ğŸ” èªè­‰èªªæ˜ï¼š</strong>
        æ‰€æœ‰ API è«‹æ±‚éƒ½éœ€è¦ Bearer Token èªè­‰ã€‚è«‹åœ¨ OpenWebUI çš„ Settings > Account ä¸­ç²å–æ‚¨çš„ API Keyï¼Œ
        ç„¶å¾Œåœ¨è«‹æ±‚æ¨™é ­ä¸­åŠ å…¥ï¼š<code>Authorization: Bearer YOUR_API_KEY</code>
    </div>

    <div class="info-panel">
        <h3>ğŸ“‹ API åˆ†é¡æ¦‚è¦½</h3>
        <ul>
            <li><strong>ğŸ¤– Ollama</strong> - æœ¬åœ°æ¨¡å‹ç®¡ç†å’Œæ¨ç†</li>
            <li><strong>ğŸŒ OpenAI</strong> - OpenAI å…¼å®¹çš„ API ç«¯é»</li>
            <li><strong>ğŸ”§ Pipelines</strong> - è‡ªå®šç¾©è™•ç†ç®¡é“</li>
            <li><strong>ğŸ“‹ Tasks</strong> - ä»»å‹™ç®¡ç†å’Œè‡ªå‹•åŒ–</li>
            <li><strong>ğŸ–¼ï¸ Images</strong> - åœ–åƒç”Ÿæˆå’Œè™•ç†</li>
            <li><strong>ğŸµ Audio</strong> - èªéŸ³åˆæˆå’Œè­˜åˆ¥</li>
            <li><strong>ğŸ“š Retrieval</strong> - RAG æ–‡æª”æª¢ç´¢</li>
            <li><strong>âš™ï¸ Configs</strong> - ç³»çµ±é…ç½®ç®¡ç†</li>
            <li><strong>ğŸ” Auths</strong> - ç”¨æˆ¶èªè­‰å’Œæˆæ¬Š</li>
            <li><strong>ğŸ‘¥ Users</strong> - ç”¨æˆ¶ç®¡ç†</li>
            <li><strong>ğŸ’¬ Chats</strong> - å°è©±ç®¡ç†</li>
            <li><strong>ğŸ“¢ Channels</strong> - é »é“åŠŸèƒ½</li>
        </ul>
    </div>

    <div id="swagger-ui"></div>

    <script src="https://unpkg.com/swagger-ui-dist@5.10.3/swagger-ui-bundle.js"></script>
    <script src="https://unpkg.com/swagger-ui-dist@5.10.3/swagger-ui-standalone-preset.js"></script>
    <script>
        // å¾ openapi.json æ–‡ä»¶è¼‰å…¥ API è¦æ ¼
        fetch('./openapi.json')
            .then(response => response.json())
            .then(spec => {
                // å¢å¼· API è¦æ ¼è³‡è¨Š
                spec.info.description = `
                    <div style="background: #f7fafc; padding: 20px; border-radius: 8px; margin: 20px 0;">
                        <h3>ğŸ¯ OpenWebUI API å®Œæ•´æ–‡æª”</h3>
                        <p>é€™æ˜¯ OpenWebUI çš„å®Œæ•´ API æ–‡æª”ï¼Œæä¾›äº†æ‰€æœ‰å¯ç”¨çš„ç«¯é»å’ŒåŠŸèƒ½ã€‚</p>
                        
                        <h4>ğŸ”— å¸¸ç”¨ç«¯é»ï¼š</h4>
                        <ul>
                            <li><strong>ç”¨æˆ¶è¨»å†Šï¼š</strong> <code>POST /api/v1/auths/signup</code></li>
                            <li><strong>ç”¨æˆ¶ç™»å…¥ï¼š</strong> <code>POST /api/v1/auths/signin</code></li>
                            <li><strong>ç²å–ç”¨æˆ¶åˆ—è¡¨ï¼š</strong> <code>GET /api/v1/users/</code></li>
                            <li><strong>èŠå¤©å°è©±ï¼š</strong> <code>POST /api/chat/completions</code></li>
                            <li><strong>æ¨¡å‹åˆ—è¡¨ï¼š</strong> <code>GET /api/models</code></li>
                            <li><strong>æ–‡ä»¶ä¸Šå‚³ï¼š</strong> <code>POST /api/v1/files/</code></li>
                        </ul>

                        <h4>âš ï¸ é‡è¦æé†’ï¼š</h4>
                        <ul>
                            <li>æ‰€æœ‰ API èª¿ç”¨éƒ½éœ€è¦æœ‰æ•ˆçš„ Bearer Token</li>
                            <li>åŸºç¤ URLï¼š<code>http://localhost:8080</code></li>
                            <li>æ”¯æ´ OpenAI å…¼å®¹çš„ API æ ¼å¼</li>
                            <li>éƒ¨åˆ†åŠŸèƒ½éœ€è¦ç®¡ç†å“¡æ¬Šé™</li>
                        </ul>
                    </div>
                `;

                // åˆå§‹åŒ– Swagger UI
                const ui = SwaggerUIBundle({
                    spec: spec,
                    dom_id: '#swagger-ui',
                    deepLinking: true,
                    presets: [
                        SwaggerUIBundle.presets.apis,
                        SwaggerUIStandalonePreset
                    ],
                    plugins: [
                        SwaggerUIBundle.plugins.DownloadUrl
                    ],
                    layout: "StandaloneLayout",
                    tryItOutEnabled: true,
                    requestInterceptor: (request) => {
                        // è‡ªå‹•ç‚ºæ‰€æœ‰è«‹æ±‚æ·»åŠ åŸºç¤ URL
                        if (!request.url.startsWith('http')) {
                            request.url = 'http://localhost:8080' + request.url;
                        }
                        return request;
                    },
                    responseInterceptor: (response) => {
                        // è™•ç†å›æ‡‰
                        return response;
                    },
                    onComplete: () => {
                        console.log('OpenWebUI API æ–‡æª”è¼‰å…¥å®Œæˆï¼');
                        
                        // æ·»åŠ è‡ªå®šç¾©æ¨£å¼
                        const style = document.createElement('style');
                        style.textContent = `
                            .swagger-ui .scheme-container {
                                background: #667eea;
                                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                            }
                            .swagger-ui .info {
                                margin: 20px 0;
                            }
                            .swagger-ui .info .title {
                                color: #2d3748;
                                font-size: 2rem;
                            }
                        `;
                        document.head.appendChild(style);
                    },
                    defaultModelsExpandDepth: 1,
                    defaultModelExpandDepth: 1,
                    displayOperationId: false,
                    displayRequestDuration: true,
                    docExpansion: 'list',
                    filter: true,
                    showExtensions: true,
                    showCommonExtensions: true,
                    supportedSubmitMethods: ['get', 'post', 'put', 'delete', 'patch']
                });

                window.ui = ui;
            })
            .catch(error => {
                console.error('è¼‰å…¥ API è¦æ ¼å¤±æ•—:', error);
                document.getElementById('swagger-ui').innerHTML = `
                    <div style="padding: 40px; text-align: center; color: #e53e3e;">
                        <h2>âŒ è¼‰å…¥å¤±æ•—</h2>
                        <p>ç„¡æ³•è¼‰å…¥ openapi.json æ–‡ä»¶ã€‚è«‹ç¢ºä¿æ–‡ä»¶å­˜åœ¨æ–¼åŒä¸€ç›®éŒ„ä¸­ã€‚</p>
                        <p>éŒ¯èª¤è©³æƒ…ï¼š${error.message}</p>
                    </div>
                `;
            });
    </script>
</body>
</html> 