<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenWebUI API 文檔 - 離線版本</title>
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/swagger-ui-dist@5.10.3/swagger-ui.css" />
    <style>
        html {
            box-sizing: border-box;
            overflow: -moz-scrollbars-vertical;
            overflow-y: scroll;
        }
        *, *:before, *:after {
            box-sizing: inherit;
        }
        body {
            margin:0;
            background: #fafafa;
        }
        .swagger-ui .topbar {
            background-color: #1f2937;
            border-bottom: 1px solid #374151;
        }
        .swagger-ui .topbar .download-url-wrapper {
            display: none;
        }
        .custom-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .custom-header h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 300;
        }
        .custom-header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1rem;
        }
        .info-panel {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .info-panel h3 {
            color: #2d3748;
            margin-top: 0;
        }
        .auth-info {
            background: #fef5e7;
            border-left: 4px solid #f6ad55;
            padding: 15px;
            margin: 20px;
            border-radius: 0 8px 8px 0;
        }
        .auth-info strong {
            color: #c05621;
        }
    </style>
</head>
<body>
    <div class="custom-header">
        <h1>🚀 OpenWebUI API 文檔</h1>
        <p>完整的 API 參考文檔 - 離線版本</p>
    </div>

    <div class="auth-info">
        <strong>🔐 認證說明：</strong>
        所有 API 請求都需要 Bearer Token 認證。請在 OpenWebUI 的 Settings > Account 中獲取您的 API Key，
        然後在請求標頭中加入：<code>Authorization: Bearer YOUR_API_KEY</code>
    </div>

    <div class="info-panel">
        <h3>📋 API 分類概覽</h3>
        <ul>
            <li><strong>🤖 Ollama</strong> - 本地模型管理和推理</li>
            <li><strong>🌐 OpenAI</strong> - OpenAI 兼容的 API 端點</li>
            <li><strong>🔧 Pipelines</strong> - 自定義處理管道</li>
            <li><strong>📋 Tasks</strong> - 任務管理和自動化</li>
            <li><strong>🖼️ Images</strong> - 圖像生成和處理</li>
            <li><strong>🎵 Audio</strong> - 語音合成和識別</li>
            <li><strong>📚 Retrieval</strong> - RAG 文檔檢索</li>
            <li><strong>⚙️ Configs</strong> - 系統配置管理</li>
            <li><strong>🔐 Auths</strong> - 用戶認證和授權</li>
            <li><strong>👥 Users</strong> - 用戶管理</li>
            <li><strong>💬 Chats</strong> - 對話管理</li>
            <li><strong>📢 Channels</strong> - 頻道功能</li>
        </ul>
    </div>

    <div id="swagger-ui"></div>

    <script src="https://unpkg.com/swagger-ui-dist@5.10.3/swagger-ui-bundle.js"></script>
    <script src="https://unpkg.com/swagger-ui-dist@5.10.3/swagger-ui-standalone-preset.js"></script>
    <script>
        // 從 openapi.json 文件載入 API 規格
        fetch('./openapi.json')
            .then(response => response.json())
            .then(spec => {
                // 增強 API 規格資訊
                spec.info.description = `
                    <div style="background: #f7fafc; padding: 20px; border-radius: 8px; margin: 20px 0;">
                        <h3>🎯 OpenWebUI API 完整文檔</h3>
                        <p>這是 OpenWebUI 的完整 API 文檔，提供了所有可用的端點和功能。</p>
                        
                        <h4>🔗 常用端點：</h4>
                        <ul>
                            <li><strong>用戶註冊：</strong> <code>POST /api/v1/auths/signup</code></li>
                            <li><strong>用戶登入：</strong> <code>POST /api/v1/auths/signin</code></li>
                            <li><strong>獲取用戶列表：</strong> <code>GET /api/v1/users/</code></li>
                            <li><strong>聊天對話：</strong> <code>POST /api/chat/completions</code></li>
                            <li><strong>模型列表：</strong> <code>GET /api/models</code></li>
                            <li><strong>文件上傳：</strong> <code>POST /api/v1/files/</code></li>
                        </ul>

                        <h4>⚠️ 重要提醒：</h4>
                        <ul>
                            <li>所有 API 調用都需要有效的 Bearer Token</li>
                            <li>基礎 URL：<code>http://localhost:8080</code></li>
                            <li>支援 OpenAI 兼容的 API 格式</li>
                            <li>部分功能需要管理員權限</li>
                        </ul>
                    </div>
                `;

                // 初始化 Swagger UI
                const ui = SwaggerUIBundle({
                    spec: spec,
                    dom_id: '#swagger-ui',
                    deepLinking: true,
                    presets: [
                        SwaggerUIBundle.presets.apis,
                        SwaggerUIStandalonePreset
                    ],
                    plugins: [
                        SwaggerUIBundle.plugins.DownloadUrl
                    ],
                    layout: "StandaloneLayout",
                    tryItOutEnabled: true,
                    requestInterceptor: (request) => {
                        // 自動為所有請求添加基礎 URL
                        if (!request.url.startsWith('http')) {
                            request.url = 'http://localhost:8080' + request.url;
                        }
                        return request;
                    },
                    responseInterceptor: (response) => {
                        // 處理回應
                        return response;
                    },
                    onComplete: () => {
                        console.log('OpenWebUI API 文檔載入完成！');
                        
                        // 添加自定義樣式
                        const style = document.createElement('style');
                        style.textContent = `
                            .swagger-ui .scheme-container {
                                background: #667eea;
                                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                            }
                            .swagger-ui .info {
                                margin: 20px 0;
                            }
                            .swagger-ui .info .title {
                                color: #2d3748;
                                font-size: 2rem;
                            }
                        `;
                        document.head.appendChild(style);
                    },
                    defaultModelsExpandDepth: 1,
                    defaultModelExpandDepth: 1,
                    displayOperationId: false,
                    displayRequestDuration: true,
                    docExpansion: 'list',
                    filter: true,
                    showExtensions: true,
                    showCommonExtensions: true,
                    supportedSubmitMethods: ['get', 'post', 'put', 'delete', 'patch']
                });

                window.ui = ui;
            })
            .catch(error => {
                console.error('載入 API 規格失敗:', error);
                document.getElementById('swagger-ui').innerHTML = `
                    <div style="padding: 40px; text-align: center; color: #e53e3e;">
                        <h2>❌ 載入失敗</h2>
                        <p>無法載入 openapi.json 文件。請確保文件存在於同一目錄中。</p>
                        <p>錯誤詳情：${error.message}</p>
                    </div>
                `;
            });
    </script>
</body>
</html> 